var __renderjsModules={};
__renderjsModules["7e839308"]=(()=>{var m=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var S=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var _=(t,e)=>{for(var i in e)m(t,i,{get:e[i],enumerable:!0})},b=(t,e,i,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of S(e))!P.call(t,o)&&o!==i&&m(t,o,{get:()=>e[o],enumerable:!(a=k(e,o))||a.enumerable});return t};var I=t=>b(m({},"__esModule",{value:!0}),t);var g=(t,e,i)=>new Promise((a,o)=>{var r=s=>{try{n(i.next(s))}catch(p){o(p)}},l=s=>{try{n(i.throw(s))}catch(p){o(p)}},n=s=>s.done?a(s.value):Promise.resolve(s.value).then(r,l);n((i=i.apply(t,e)).next())});var T={};_(T,{default:()=>L});var u=[],h=null,L={data(){return{map:{},directionsService:{},receiveLocaDate:{lat:"",lon:""},receiveTraceDate:[],routesInfo:[]}},mounted(){let t=this,e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB3SXIcka2RbPu1WamesFrSt692xlwehX4&libraries=places&callback=initMap",window.initMap=function(){setTimeout(()=>{__f__("log","at pages/map/map.vue:167","renderScript"),t.initMap()},1500)},document.head.appendChild(e)},methods:{getData(t){__f__("log","at pages/map/map.vue:177","newValue",t.lat),t&&(this.receiveLocaDate=t)},loadGoogleMapsScript(){let t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places",t.async=!0,t.defer=!0,t.onload=this.initMap,document.head.appendChild(t)},initMap(){return g(this,null,function*(){this.map=new google.maps.Map(document.getElementById("map"),{center:{lat:37.7749,lng:-122.4194},zoom:10}),this.directionsService=new google.maps.DirectionsService;let t=this.receiveLocaDate.startLoc,e=this.receiveLocaDate.endLoc;this.directionsService.route({origin:t,destination:e,travelMode:this.receiveLocaDate.selectedMode,provideRouteAlternatives:!0},(i,a)=>g(this,null,function*(){if(a==="OK"){this.routesInfo=[];let o=i.routes;for(let r=0;r<o.length;r++){let l=o[r];new google.maps.DirectionsRenderer({map:this.map,directions:i,routeIndex:r,polylineOptions:{strokeColor:this.getRandomColor()}}),yield this.displayAirQualityAlongRoute(l,r)}}else uni.showToast({title:"Directions request failed due to "+a,icon:"none"})}))})},getRandomColor(){let t="0123456789ABCDEF",e="#";for(let i=0;i<6;i++)e+=t[Math.floor(Math.random()*16)];return e},displayAirQualityAlongRoute(t,e){return g(this,null,function*(){let i=0,a=0,o=0,r=0;for(let p of t.legs){i+=p.duration.value/60,a+=p.distance.value/1e3;for(let f of p.steps){let d=f.start_location,c=yield this.getAirQuality(d.lat(),d.lng()),y=yield this.getPlaceName(d.lat(),d.lng());if(c){o+=c.aqi,r++;let v=`rgb(${Math.round(c.color.red*255)}, ${Math.round(c.color.green*255)}, ${Math.round(c.color.blue*255)})`,w=new google.maps.Marker({position:d,map:this.map,icon:this.getCircle(v)}),M=new google.maps.InfoWindow({content:`<div class="infoWindow">
			                          <strong>Location:</strong> ${y}<br>
			                          <strong>Air Quality:</strong> ${c.aqiDisplay} (${c.category})<br>
			                          <strong>Dominant Pollutant:</strong> ${c.dominantPollutant}
			                        </div>`});w.addListener("click",function(){M.open(this.map,this)})}}}let l=r?o/r:1/0;this.displayHealthTips(e+1,l);let n="";l<=50?n="Low Pollution":l<=100?n="Moderate Pollution":n="High Pollution";let s=document.createElement("li");s.innerHTML=`<strong>Route ${e+1}</strong>: ${i.toFixed(2)} mins, ${a.toFixed(2)} km, ${n}`,document.getElementById("routes-list").appendChild(s),this.routesInfo.push({duration:i.toFixed(2),distance:a.toFixed(2),pollution:n})})},getAirQuality(t,e){return g(this,null,function*(){let o=yield(yield fetch("https://airquality.googleapis.com/v1/currentConditions:lookup?key=AIzaSyB3SXIcka2RbPu1WamesFrSt692xlwehX4",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:{latitude:t,longitude:e}})})).json();return o.indexes&&o.indexes.length>0?o.indexes[0]:(__f__("error","at pages/map/map.vue:318","No air quality data found for this location."),null)})},getPlaceName(t,e){return g(this,null,function*(){let o=yield(yield fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${t},${e}&key=AIzaSyB3SXIcka2RbPu1WamesFrSt692xlwehX4`)).json();return o.results&&o.results.length>0?o.results[0].formatted_address:(__f__("error","at pages/map/map.vue:329","No place name found for this location."),"Unknown location")})},getCircle(t){let e=document.createElement("canvas"),i=e.getContext("2d"),a=20;return e.width=a,e.height=a,i.beginPath(),i.arc(a/2,a/2,a/2,0,2*Math.PI),i.fillStyle=t,i.fill(),{url:e.toDataURL(),size:new google.maps.Size(a,a),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(a/2,a/2),scaledSize:new google.maps.Size(a,a)}},displayHealthTips(t,e){return g(this,null,function*(){let i=document.querySelector(".health-tips"),a=document.createElement("h3");a.innerHTML=`<h3>Router ${t}:Health & Safety Tips</h3>`,i.appendChild(a);let o={"Low Pollution":["<strong>Wear a Mask</strong>: Use a mask that filters out fine particles (PM2.5) to protect your respiratory system, especially on days with high pollution.","<strong>Travel During Low Traffic Times</strong>: Plan your routes during early mornings or late evenings when pollution levels tend to be lower due to reduced traffic.","<strong>Choose Greener Paths</strong>: Opt for routes that go through parks or areas with more greenery, as plants can help absorb pollutants.","<strong>Stay Hydrated</strong>: Drink plenty of water to help your body flush out toxins and stay hydrated, which can improve your overall resistance to pollution.","<strong>Limit Exposure to Pollutants</strong>: Minimize outdoor activities on high pollution days and spend more time indoors."],"Moderate Pollution":["<strong>Monitor Air Quality</strong>: Regularly check the air quality index (AQI) and avoid outdoor activities when pollution levels are high.","<strong>Limit Intense Activities</strong>: Avoid strenuous activities like running or cycling on high pollution days to reduce the amount of pollutants you inhale.","<strong>Use Protective Gear</strong>: Wear protective eyewear to prevent irritation from pollutants, and consider using air purifiers at home to ensure clean indoor air.","<strong>Take Shorter Routes</strong>: Opt for shorter routes or use public transportation to reduce your exposure to outdoor pollutants.","<strong>Eat Healthily</strong>: Consume foods rich in antioxidants, such as fruits and vegetables, to help your body fight the effects of pollution."],"High Pollution":["<strong>Stay Informed</strong>: Keep yourself updated with real-time air quality data and weather forecasts to make informed decisions about your travel plans.","<strong>Indoor Activities</strong>: Engage in indoor activities like reading, cooking, or indoor exercises to minimize exposure to outdoor pollutants.","<strong>Seal Windows</strong>: Keep windows and doors closed during periods of high pollution to prevent pollutants from entering your home.","<strong>Use Air Purifiers</strong>: Install air purifiers in your home to filter out pollutants and improve indoor air quality.","<strong>Reduce Car Usage</strong>: Limit driving and carpool whenever possible to reduce emissions and lower overall pollution levels."]},r=[];for(let n in o)Object.hasOwnProperty.call(o,n)&&r.push(...o[n]);let l=[];e<=50?l.push(...this.getRandomTips(o["Low Pollution"])):e<=100?l.push(...this.getRandomTips(o["Moderate Pollution"])):l.push(...this.getRandomTips(o["High Pollution"])),l.sort(()=>Math.random()-.5),l.forEach(n=>{let s=document.createElement("li");s.innerHTML=n,i.appendChild(s)})})},getRandomTips(t){let e=[],i=Math.floor(Math.random()*t.length)+1,a=t.sort(()=>Math.random()-.5);for(let o=0;o<i;o++)e.push(a[o]);return e},setMePositioning(){let t=this,e=new google.maps.Marker({position:{lat:parseFloat(t.receiveLocaDate.lat),lng:parseFloat(t.receiveLocaDate.lon)},icon:{url:"https://maps.gstatic.com/mapfiles/ms2/micons/red.png",scaledSize:new google.maps.Size(50,50)},map:t.map});u.push(e)},receiveLoca(t,e,i,a){let o=this;JSON.stringify(t)!="{}"&&t.length!=0&&(o.receiveLocaDate=t)},receiveTrace(t,e,i,a){let o=this;if(JSON.stringify(t)!="{}"&&t.length!=0){__f__("log","at pages/map/map.vue:451","\u89E6\u53D1\u4E86",t,t.length);for(let s=0;s<u.length;s++)u[s].setMap(null);h!=null&&h.setMap(null),o.map.setZoom(20);let r=new google.maps.Marker({position:{lat:parseFloat(t[0].lat),lng:parseFloat(t[0].lng)},icon:{url:"static/img/map/icon_start.png",scaledSize:new google.maps.Size(20,20)},map:o.map});u.push(r);let l=new google.maps.Marker({position:{lat:parseFloat(t[t.length-1].lat),lng:parseFloat(t[t.length-1].lng)},icon:{url:"static/img/map/icon_end.png",scaledSize:new google.maps.Size(20,20)},map:o.map});u.push(l),h=new google.maps.Polyline({path:t,geodesic:!1,strokeColor:"#41d9b7",strokeOpacity:1,strokeWeight:8,editable:!1,draggable:!1}),h.setMap(o.map);let n={lat:parseFloat(t[0].lat),lng:parseFloat(t[0].lng)};o.map.setCenter(n)}}}};return I(T);})();
